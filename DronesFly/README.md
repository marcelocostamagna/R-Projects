---
title: "Four Clustering Approaches For A Sinlge Drone Fly"
author: "Marcelo Costamagna"
date: "January 21, 2019"
# output:
#   html_document:
#     df_print: paged
#   pdf_document: default
#   word_document: default

output:
  html_document:
    keep_md: true
    theme: paper
    highlight: tango
    toc: true
    toc_depth: 2
    number_sections: true
    code_folding: show
    fig_height: 4.5
    fig_width: 10
    fig.align: center
---




```r
library(readxl)
library(tidyverse)
library(plotly)
library(dbscan)
library(fpc)
library(cluster)
library(factoextra)
library(NbClust)
```


# Data Preparation
## Data Loading

```r

head(mtcars , 5)
```

Data comes from an Excel file with serveral useless columns for this analysis so we'll get rid of them:


```r
Angles_Mav_ <- read_excel("data/Compared_Angles_Mav_2018-02-21.xlsx",
                          col_types = c("skip", "skip", "skip", 
                                        "skip", "skip", "numeric", "numeric", 
                                        "numeric", "skip", "skip", "skip", 
                                        "skip", "skip", "skip", "skip"))
Angles_Mav_ <- na.exclude(Angles_Mav_)
head(Angles_Mav_ , 5)
```

```
## # A tibble: 5 x 3
##   `Distance (Rho)` `Altitude (z)` `Angles (Theta)`
##              <dbl>          <dbl>            <dbl>
## 1             109.           40.6             43.9
## 2             109.           40.6            337. 
## 3             108.           40.6            354. 
## 4             108.           40.7            354. 
## 5             108.           40.7            348.
```


## Convertion from Polar Cylindrical Coordinates to Cartesian Coordinates

In order to plot values we need to convert it to x, y, z points and then we'll plot them:


```r
x <- vector(mode="numeric", length=0)
y <- vector(mode="numeric", length=0)
z <- vector(mode="numeric", length=0)
for (i in 1:nrow(Angles_Mav_)) {
  radius <- as.numeric(Angles_Mav_$`Distance (Rho)`[i]) #distance rho (radius)
  theta <- as.numeric(Angles_Mav_$`Angles (Theta)`[i])  # angle theta
  altitude <- Angles_Mav_$`Altitude (z)`[i]             # altitude
  x[i] <-  radius * cos(theta)
  y[i] <-  radius * sin(theta)
  z[i] <-  altitude
}
```

```
## # A tibble: 5 x 3
##        x      y     z
##    <dbl>  <dbl> <dbl>
## 1  108.   -11.2  40.6
## 2  -53.6  -94.5  40.6
## 3  -25.4  105.   40.6
## 4  -73.1   79.8  40.7
## 5  -93.2   54.6  40.7
```

<!--html_preserve--><div id="htmlwidget-56088e49f09becd268ad" style="width:960px;height:432px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-56088e49f09becd268ad">{"x":{"visdat":{"29887adc2383":["function () ","plotlyVisDat"]},"cur_data":"29887adc2383","attrs":{"29887adc2383":{"y":{},"x":{},"z":{},"mode":"markers","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":"x"},"yaxis":{"title":"y"},"zaxis":{"title":"z"}},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"data":[{"y":[-11.1989155718138,-94.5215560217025,105.402509945865,79.8395071530135,54.5793663125589,95.7826463421585,-103.535058672989,99.0683873794258,-107.3798875915,87.3115199494999,-93.0856175505621,-63.0321384159762,53.1553114232179,41.4742463224904,16.7436883365372,104.23808360062,-34.4181646240076,-100.00922170618,3.47155299490898,-85.4894498595401,59.6480141950757,-55.2908601328611,91.3979867370876,108.290760743988,5.42011860323054,-76.2791470547749,-52.5634393541185,-97.7614174440492,103.223275561112,-69.1359837028094,59.6496125710285,35.3321453942107,-37.0840577932202,-69.4196406229038,100.914973298334,62.0457206201431,51.7913796204501,-100.443169923167,-92.4167058433574,-72.5777167514862,67.1017500675749,85.7887312637746,-76.5557511125351,-10.3937462735013,-129.823216217169,186.157548958437,-130.766555899541,-164.09149780479,147.40211026554,231.699120456583,-255.726615228078,71.4741213459351,121.02522955622,-169.924253633104,146.160620137154,3.06069860435647,-92.3110791025393,78.4580401591259,-25.4319150977956,73.088572376748,142.912014212231,246.9486947006,-267.042066896776,-14.5377887298697,196.104113207139,179.552016623346,-229.768123171647,-87.0058408772088,-93.1674172288335,91.7909938560068,60.1878779867208,-64.3330171786875,77.001972537752,79.6975729253657,26.9842811643248,-83.6907434859261,85.7377445484999,-144.202833753023,104.177698739529,-41.9284037118584,-246.339456410531,151.24311827849,-283.31483482584,285.482753773529,-261.946125917193,271.014460696898,-48.4389762123614,239.744339032937,261.824877652945,-263.095463251535,44.5398462560981,-273.911448080474,95.5730526501524,235.568079578949,-233.264171319263,268.29788217524,285.188271009259,-92.5361260926697,135.106630767084,38.812094459523,286.225785429804,136.863697328884,-11.4729325068946,364.298851836843,679.443281486844,-923.136001937492,569.990130215778],"x":[107.932974162373,-53.5965720858851,-25.3983230114088,-73.0522092612053,-93.2288132224917,-50.2555991225955,33.723260645487,-45.8013694702806,-18.5706416287649,-64.7112997752121,55.6454977615785,-87.9903989543212,-93.7406157155848,-99.8209849475799,107.065267615429,-30.2877169746095,-102.764502260485,41.9148620677168,-108.708163050336,-66.2535240882062,-90.2386073792007,93.0307227697083,57.5592923144988,-1.40289602110972,-108.393805307414,77.3537400454575,-94.8037737754161,46.3638869652891,33.2866220437947,83.739351861485,-90.8228731723972,-102.800705324714,-95.2430369341743,-73.3891973927984,-8.07398537068056,-79.8960867117244,-86.8950314931343,10.9849952737306,-40.1971417615259,70.2835479191457,-74.805545983788,-52.1691016515593,-64.9254440742338,-95.618112998986,-56.2705574533161,192.16230065912,290.832910799303,-193.832554579872,179.995515876935,-54.6238853581405,-159.550426203921,-231.148126536323,-195.805715538763,-138.541873206742,149.049014311733,182.016349818509,-37.3097574555833,-68.9634307705128,124.032275910836,-163.633231156133,-254.990159649986,127.923448314125,38.5675031986941,-291.383780714066,-200.904115725653,-172.716208151,89.3488402989791,-183.572554899845,-118.766216682369,-118.474969352928,-92.0439015338075,-69.4268707433247,-53.0413195280152,48.8780388936435,-89.727044269772,42.6196005165887,37.7298301000567,-13.3207503199545,157.524148774579,220.169464124023,-102.055418982766,-242.630923725256,-36.4567928495035,-0.169059524776606,-113.779996664927,-89.7136090058253,281.522711749918,155.579365929434,115.523784182304,-112.820506421065,-282.952438838825,-82.4013496594536,-269.087338041856,160.104825183994,164.474832801868,98.6737799632721,-16.6591862225212,270.177175213875,251.595699861259,-282.299734387552,-61.230910760292,357.685586758781,-489.683763640364,-473.135978970174,381.652788494177,277.096580006298,-971.421941265776],"z":[40.6,40.6,40.6,40.7,40.7,40.8,40.7,40.6,40.5,40.6,40.7,40.7,40.8,40.8,40.7,40.6,40.7,40.8,40.7,40.8,40.7,40.6,40.7,40.5,40.6,40.6,40.7,40.7,40.7,40.7,40.6,40.8,40.6,40.7,40.7,40.6,40.7,42.2,51.1,51.2,51.5,51.3,51.4,51.4,51.6,51.3,51.4,51.4,51.4,51.5,51.5,51.6,51.7,51.3,51.4,51.5,51.2,51.5,51.4,51.5,51.3,51.2,51.4,50.6,50.7,50.6,50.5,50.5,50.7,50.7,50.6,50.6,50.6,50.6,50.7,50.7,50.5,50.6,50.6,50.6,50.7,50.6,50.6,50.7,50.7,50.6,50.7,50.6,50.7,50.6,50.6,50.7,50.7,50.6,50.7,50.7,50.8,50.8,50.7,50.6,50.6,50.8,50.7,50.8,50.8,50.7,50.7],"mode":"markers","type":"scatter3d","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":[]}</script><!--/html_preserve-->

#Clustering

## Defining optimal number of clusters

```r
#Elbow method
fviz_nbclust(scale(Angles_Mav_xyz), kmeans, method = "wss") +
  geom_vline(xintercept = 4, linetype = 2) +
  labs(subtitle = "Elbow method")
```

![](RMD_Clusterig_Summary_files/figure-html/Elbow method-1.png)<!-- -->


## 1 - Basic K-means 
We'll begin with a simplea approach, considering 4 clusters and unscaled data

```r
k_vect <- Angles_Mav_xyz %>%
  select( y, x, z) %>% 
  kmeans(., 4, nstart = 25)
```


```
## K-means clustering with 4 clusters of sizes: 
##  2 45 36 24 
##  
## Within cluster sum of squares by cluster: 
##  145298.9 717819.3 1158916 846057.7 
##  
## Within  sum of squares: 
##  2868092
```

<!--html_preserve--><div id="htmlwidget-a7e1dfbe4ac99c540942" style="width:960px;height:432px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-a7e1dfbe4ac99c540942">{"x":{"visdat":{"29881f5f2f3e":["function () ","plotlyVisDat"]},"cur_data":"29881f5f2f3e","attrs":{"29881f5f2f3e":{"y":{},"x":{},"z":{},"mode":"markers","color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":"x"},"yaxis":{"title":"y"},"zaxis":{"title":"z"}},"hovermode":"closest","showlegend":false,"legend":{"yanchor":"top","y":0.5}},"source":"A","config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"data":[{"y":[-11.1989155718138,-94.5215560217025,105.402509945865,79.8395071530135,54.5793663125589,95.7826463421585,-103.535058672989,99.0683873794258,-107.3798875915,87.3115199494999,-93.0856175505621,-63.0321384159762,53.1553114232179,41.4742463224904,16.7436883365372,104.23808360062,-34.4181646240076,-100.00922170618,3.47155299490898,-85.4894498595401,59.6480141950757,-55.2908601328611,91.3979867370876,108.290760743988,5.42011860323054,-76.2791470547749,-52.5634393541185,-97.7614174440492,103.223275561112,-69.1359837028094,59.6496125710285,35.3321453942107,-37.0840577932202,-69.4196406229038,100.914973298334,62.0457206201431,51.7913796204501,-100.443169923167,-92.4167058433574,-72.5777167514862,67.1017500675749,85.7887312637746,-76.5557511125351,-10.3937462735013,-129.823216217169,186.157548958437,-130.766555899541,-164.09149780479,147.40211026554,231.699120456583,-255.726615228078,71.4741213459351,121.02522955622,-169.924253633104,146.160620137154,3.06069860435647,-92.3110791025393,78.4580401591259,-25.4319150977956,73.088572376748,142.912014212231,246.9486947006,-267.042066896776,-14.5377887298697,196.104113207139,179.552016623346,-229.768123171647,-87.0058408772088,-93.1674172288335,91.7909938560068,60.1878779867208,-64.3330171786875,77.001972537752,79.6975729253657,26.9842811643248,-83.6907434859261,85.7377445484999,-144.202833753023,104.177698739529,-41.9284037118584,-246.339456410531,151.24311827849,-283.31483482584,285.482753773529,-261.946125917193,271.014460696898,-48.4389762123614,239.744339032937,261.824877652945,-263.095463251535,44.5398462560981,-273.911448080474,95.5730526501524,235.568079578949,-233.264171319263,268.29788217524,285.188271009259,-92.5361260926697,135.106630767084,38.812094459523,286.225785429804,136.863697328884,-11.4729325068946,364.298851836843,679.443281486844,-923.136001937492,569.990130215778],"x":[107.932974162373,-53.5965720858851,-25.3983230114088,-73.0522092612053,-93.2288132224917,-50.2555991225955,33.723260645487,-45.8013694702806,-18.5706416287649,-64.7112997752121,55.6454977615785,-87.9903989543212,-93.7406157155848,-99.8209849475799,107.065267615429,-30.2877169746095,-102.764502260485,41.9148620677168,-108.708163050336,-66.2535240882062,-90.2386073792007,93.0307227697083,57.5592923144988,-1.40289602110972,-108.393805307414,77.3537400454575,-94.8037737754161,46.3638869652891,33.2866220437947,83.739351861485,-90.8228731723972,-102.800705324714,-95.2430369341743,-73.3891973927984,-8.07398537068056,-79.8960867117244,-86.8950314931343,10.9849952737306,-40.1971417615259,70.2835479191457,-74.805545983788,-52.1691016515593,-64.9254440742338,-95.618112998986,-56.2705574533161,192.16230065912,290.832910799303,-193.832554579872,179.995515876935,-54.6238853581405,-159.550426203921,-231.148126536323,-195.805715538763,-138.541873206742,149.049014311733,182.016349818509,-37.3097574555833,-68.9634307705128,124.032275910836,-163.633231156133,-254.990159649986,127.923448314125,38.5675031986941,-291.383780714066,-200.904115725653,-172.716208151,89.3488402989791,-183.572554899845,-118.766216682369,-118.474969352928,-92.0439015338075,-69.4268707433247,-53.0413195280152,48.8780388936435,-89.727044269772,42.6196005165887,37.7298301000567,-13.3207503199545,157.524148774579,220.169464124023,-102.055418982766,-242.630923725256,-36.4567928495035,-0.169059524776606,-113.779996664927,-89.7136090058253,281.522711749918,155.579365929434,115.523784182304,-112.820506421065,-282.952438838825,-82.4013496594536,-269.087338041856,160.104825183994,164.474832801868,98.6737799632721,-16.6591862225212,270.177175213875,251.595699861259,-282.299734387552,-61.230910760292,357.685586758781,-489.683763640364,-473.135978970174,381.652788494177,277.096580006298,-971.421941265776],"z":[40.6,40.6,40.6,40.7,40.7,40.8,40.7,40.6,40.5,40.6,40.7,40.7,40.8,40.8,40.7,40.6,40.7,40.8,40.7,40.8,40.7,40.6,40.7,40.5,40.6,40.6,40.7,40.7,40.7,40.7,40.6,40.8,40.6,40.7,40.7,40.6,40.7,42.2,51.1,51.2,51.5,51.3,51.4,51.4,51.6,51.3,51.4,51.4,51.4,51.5,51.5,51.6,51.7,51.3,51.4,51.5,51.2,51.5,51.4,51.5,51.3,51.2,51.4,50.6,50.7,50.6,50.5,50.5,50.7,50.7,50.6,50.6,50.6,50.6,50.7,50.7,50.5,50.6,50.6,50.6,50.7,50.6,50.6,50.7,50.7,50.6,50.7,50.6,50.7,50.6,50.6,50.7,50.7,50.6,50.7,50.7,50.8,50.8,50.7,50.6,50.6,50.8,50.7,50.8,50.8,50.7,50.7],"mode":"markers","type":"scatter3d","marker":{"colorbar":{"title":"k_cluster_basic","ticklen":2},"cmin":1,"cmax":4,"colorscale":[["0","rgba(68,1,84,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.666666666666667","rgba(53,183,121,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"]],"showscale":false,"color":[4,3,2,2,2,2,3,2,3,2,3,3,2,2,4,2,2,3,2,3,2,3,4,2,2,3,3,3,4,3,2,2,2,3,2,2,2,3,3,3,2,2,3,2,3,4,4,3,4,2,3,2,2,3,4,4,3,2,4,2,2,4,3,2,2,2,3,3,3,2,2,3,2,4,2,3,4,3,4,4,3,2,3,2,3,2,4,4,4,3,2,3,2,4,3,4,2,4,4,2,2,4,2,1,4,3,1],"line":{"colorbar":{"title":"","ticklen":2},"cmin":1,"cmax":4,"colorscale":[["0","rgba(68,1,84,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.666666666666667","rgba(53,183,121,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"]],"showscale":false,"color":[4,3,2,2,2,2,3,2,3,2,3,3,2,2,4,2,2,3,2,3,2,3,4,2,2,3,3,3,4,3,2,2,2,3,2,2,2,3,3,3,2,2,3,2,3,4,4,3,4,2,3,2,2,3,4,4,3,2,4,2,2,4,3,2,2,2,3,3,3,2,2,3,2,4,2,3,4,3,4,4,3,2,3,2,3,2,4,4,4,3,2,3,2,4,3,4,2,4,4,2,2,4,2,1,4,3,1]}},"frame":null},{"x":[-971.421941265776,381.652788494177],"y":[-923.136001937492,679.443281486844],"type":"scatter3d","mode":"markers","opacity":0,"hoverinfo":"none","showlegend":false,"marker":{"colorbar":{"title":"k_cluster_basic","ticklen":2,"len":0.5,"lenmode":"fraction","y":1,"yanchor":"top"},"cmin":1,"cmax":4,"colorscale":[["0","rgba(68,1,84,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.666666666666667","rgba(53,183,121,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"]],"showscale":true,"color":[1,4],"line":{"color":"rgba(255,127,14,1)"}},"z":[40.5,51.7],"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":[]}</script><!--/html_preserve-->


## 2 - Scaled K-means

Generally variables are scaled to have:
a) standard deviation one 
b) mean zero.
The standardization of data is an approach widely used  before clustering.


```r
scale_angles <- scale(Angles_Mav_xyz[, 2:4])
set.seed(123)
km_ang <- kmeans(scale_angles, 4, nstart = 25)
```


```
## K-means clustering with 4 clusters of sizes: 
##  38 22 25 22 
##  
## Within cluster sum of squares by cluster: 
##  12.11293 25.7764 41.90451 27.90894 
##  
## Within  sum of squares: 
##  107.7028
```

<!--html_preserve--><div id="htmlwidget-61046ceed3e30ea6266d" style="width:960px;height:432px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-61046ceed3e30ea6266d">{"x":{"visdat":{"29882aa35238":["function () ","plotlyVisDat"]},"cur_data":"29882aa35238","attrs":{"29882aa35238":{"y":{},"x":{},"z":{},"mode":"markers","color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":"x"},"yaxis":{"title":"y"},"zaxis":{"title":"z"}},"hovermode":"closest","showlegend":false,"legend":{"yanchor":"top","y":0.5}},"source":"A","config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"data":[{"y":[-11.1989155718138,-94.5215560217025,105.402509945865,79.8395071530135,54.5793663125589,95.7826463421585,-103.535058672989,99.0683873794258,-107.3798875915,87.3115199494999,-93.0856175505621,-63.0321384159762,53.1553114232179,41.4742463224904,16.7436883365372,104.23808360062,-34.4181646240076,-100.00922170618,3.47155299490898,-85.4894498595401,59.6480141950757,-55.2908601328611,91.3979867370876,108.290760743988,5.42011860323054,-76.2791470547749,-52.5634393541185,-97.7614174440492,103.223275561112,-69.1359837028094,59.6496125710285,35.3321453942107,-37.0840577932202,-69.4196406229038,100.914973298334,62.0457206201431,51.7913796204501,-100.443169923167,-92.4167058433574,-72.5777167514862,67.1017500675749,85.7887312637746,-76.5557511125351,-10.3937462735013,-129.823216217169,186.157548958437,-130.766555899541,-164.09149780479,147.40211026554,231.699120456583,-255.726615228078,71.4741213459351,121.02522955622,-169.924253633104,146.160620137154,3.06069860435647,-92.3110791025393,78.4580401591259,-25.4319150977956,73.088572376748,142.912014212231,246.9486947006,-267.042066896776,-14.5377887298697,196.104113207139,179.552016623346,-229.768123171647,-87.0058408772088,-93.1674172288335,91.7909938560068,60.1878779867208,-64.3330171786875,77.001972537752,79.6975729253657,26.9842811643248,-83.6907434859261,85.7377445484999,-144.202833753023,104.177698739529,-41.9284037118584,-246.339456410531,151.24311827849,-283.31483482584,285.482753773529,-261.946125917193,271.014460696898,-48.4389762123614,239.744339032937,261.824877652945,-263.095463251535,44.5398462560981,-273.911448080474,95.5730526501524,235.568079578949,-233.264171319263,268.29788217524,285.188271009259,-92.5361260926697,135.106630767084,38.812094459523,286.225785429804,136.863697328884,-11.4729325068946,364.298851836843,679.443281486844,-923.136001937492,569.990130215778],"x":[107.932974162373,-53.5965720858851,-25.3983230114088,-73.0522092612053,-93.2288132224917,-50.2555991225955,33.723260645487,-45.8013694702806,-18.5706416287649,-64.7112997752121,55.6454977615785,-87.9903989543212,-93.7406157155848,-99.8209849475799,107.065267615429,-30.2877169746095,-102.764502260485,41.9148620677168,-108.708163050336,-66.2535240882062,-90.2386073792007,93.0307227697083,57.5592923144988,-1.40289602110972,-108.393805307414,77.3537400454575,-94.8037737754161,46.3638869652891,33.2866220437947,83.739351861485,-90.8228731723972,-102.800705324714,-95.2430369341743,-73.3891973927984,-8.07398537068056,-79.8960867117244,-86.8950314931343,10.9849952737306,-40.1971417615259,70.2835479191457,-74.805545983788,-52.1691016515593,-64.9254440742338,-95.618112998986,-56.2705574533161,192.16230065912,290.832910799303,-193.832554579872,179.995515876935,-54.6238853581405,-159.550426203921,-231.148126536323,-195.805715538763,-138.541873206742,149.049014311733,182.016349818509,-37.3097574555833,-68.9634307705128,124.032275910836,-163.633231156133,-254.990159649986,127.923448314125,38.5675031986941,-291.383780714066,-200.904115725653,-172.716208151,89.3488402989791,-183.572554899845,-118.766216682369,-118.474969352928,-92.0439015338075,-69.4268707433247,-53.0413195280152,48.8780388936435,-89.727044269772,42.6196005165887,37.7298301000567,-13.3207503199545,157.524148774579,220.169464124023,-102.055418982766,-242.630923725256,-36.4567928495035,-0.169059524776606,-113.779996664927,-89.7136090058253,281.522711749918,155.579365929434,115.523784182304,-112.820506421065,-282.952438838825,-82.4013496594536,-269.087338041856,160.104825183994,164.474832801868,98.6737799632721,-16.6591862225212,270.177175213875,251.595699861259,-282.299734387552,-61.230910760292,357.685586758781,-489.683763640364,-473.135978970174,381.652788494177,277.096580006298,-971.421941265776],"z":[40.6,40.6,40.6,40.7,40.7,40.8,40.7,40.6,40.5,40.6,40.7,40.7,40.8,40.8,40.7,40.6,40.7,40.8,40.7,40.8,40.7,40.6,40.7,40.5,40.6,40.6,40.7,40.7,40.7,40.7,40.6,40.8,40.6,40.7,40.7,40.6,40.7,42.2,51.1,51.2,51.5,51.3,51.4,51.4,51.6,51.3,51.4,51.4,51.4,51.5,51.5,51.6,51.7,51.3,51.4,51.5,51.2,51.5,51.4,51.5,51.3,51.2,51.4,50.6,50.7,50.6,50.5,50.5,50.7,50.7,50.6,50.6,50.6,50.6,50.7,50.7,50.5,50.6,50.6,50.6,50.7,50.6,50.6,50.7,50.7,50.6,50.7,50.6,50.7,50.6,50.6,50.7,50.7,50.6,50.7,50.7,50.8,50.8,50.7,50.6,50.6,50.8,50.7,50.8,50.8,50.7,50.7],"mode":"markers","type":"scatter3d","marker":{"colorbar":{"title":"k_cluster_scaled","ticklen":2},"cmin":1,"cmax":4,"colorscale":[["0","rgba(68,1,84,1)"],["0","rgba(68,1,84,1)"],["0","rgba(68,1,84,1)"],["0","rgba(68,1,84,1)"],["0","rgba(68,1,84,1)"],["0","rgba(68,1,84,1)"],["0","rgba(68,1,84,1)"],["0","rgba(68,1,84,1)"],["0","rgba(68,1,84,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.666666666666667","rgba(53,183,121,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"]],"showscale":false,"color":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4,4,3,3,4,3,4,2,2,4,2,3,4,3,3,4,2,2,4,3,2,3,3,2,4,3,3,3,4,4,4,3,3,4,3,2,3,4,2,4,2,2,4,3,4,2,4,3,2,2,2,4,3,4,3,2,4,2,2,2,2,3,3,2,3,3,2,4,3],"line":{"colorbar":{"title":"","ticklen":2},"cmin":1,"cmax":4,"colorscale":[["0","rgba(68,1,84,1)"],["0","rgba(68,1,84,1)"],["0","rgba(68,1,84,1)"],["0","rgba(68,1,84,1)"],["0","rgba(68,1,84,1)"],["0","rgba(68,1,84,1)"],["0","rgba(68,1,84,1)"],["0","rgba(68,1,84,1)"],["0","rgba(68,1,84,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.666666666666667","rgba(53,183,121,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"]],"showscale":false,"color":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4,4,3,3,4,3,4,2,2,4,2,3,4,3,3,4,2,2,4,3,2,3,3,2,4,3,3,3,4,4,4,3,3,4,3,2,3,4,2,4,2,2,4,3,4,2,4,3,2,2,2,4,3,4,3,2,4,2,2,2,2,3,3,2,3,3,2,4,3]}},"frame":null},{"x":[-971.421941265776,381.652788494177],"y":[-923.136001937492,679.443281486844],"type":"scatter3d","mode":"markers","opacity":0,"hoverinfo":"none","showlegend":false,"marker":{"colorbar":{"title":"k_cluster_scaled","ticklen":2,"len":0.5,"lenmode":"fraction","y":1,"yanchor":"top"},"cmin":1,"cmax":4,"colorscale":[["0","rgba(68,1,84,1)"],["0","rgba(68,1,84,1)"],["0","rgba(68,1,84,1)"],["0","rgba(68,1,84,1)"],["0","rgba(68,1,84,1)"],["0","rgba(68,1,84,1)"],["0","rgba(68,1,84,1)"],["0","rgba(68,1,84,1)"],["0","rgba(68,1,84,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.666666666666667","rgba(53,183,121,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"]],"showscale":true,"color":[1,4],"line":{"color":"rgba(255,127,14,1)"}},"z":[40.5,51.7],"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":[]}</script><!--/html_preserve-->
**Within Sum of Squares  decreases dramatically when data is scaled**

## 3-DBSCAN - Density Based Spacial Clustering of Aplications with Noise 

Density-based clustering constructs clusters in regard to the density measurement. Clusters in this method have a higher density than the remainder of the dataset.
This algorithm works on a parametric approach.
a) Epsilon: the radius of our neighborhoods around a data point p.
b) minPts: the minimum number of data points we want in a neighborhood to define a cluster.


```r
#DBSCAN input must be a matrix.
angles_matrix <- as.matrix(Angles_Mav_xyz[,2:4])
angles_matrix_sca <- scale(angles_matrix)

#this plot helps us to define the value of epsilon
kNNdistplot(angles_matrix_sca, k=25) #tells us that the ideal values of "e" is between 1 and 2
abline(h=1.5, col="red")
```

![](RMD_Clusterig_Summary_files/figure-html/density based-1.png)<!-- -->

The plot suggests that the  **epsilon distance** should be between 1 and 2



```r
set.seed(1234)
db <-  dbscan::dbscan(angles_matrix_sca, eps = 1.6, minPts = 10)
print(db)
```

```
## DBSCAN clustering for 107 objects.
## Parameters: eps = 1.6, minPts = 10
## The clustering contains 2 cluster(s) and 4 noise points.
## 
##  0  1  2 
##  4 38 65 
## 
## Available fields: cluster, eps, minPts
```

Density based method suggests that the number of cluster should be 2. Cluster "0"" contains all the values labeled as "noise".

<!--html_preserve--><div id="htmlwidget-00490a1238b84590b552" style="width:960px;height:432px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-00490a1238b84590b552">{"x":{"visdat":{"298848f2ba3":["function () ","plotlyVisDat"]},"cur_data":"298848f2ba3","attrs":{"298848f2ba3":{"y":{},"x":{},"z":{},"mode":"markers","color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":"x"},"yaxis":{"title":"y"},"zaxis":{"title":"z"}},"hovermode":"closest","showlegend":false,"legend":{"yanchor":"top","y":0.5}},"source":"A","config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"data":[{"y":[-11.1989155718138,-94.5215560217025,105.402509945865,79.8395071530135,54.5793663125589,95.7826463421585,-103.535058672989,99.0683873794258,-107.3798875915,87.3115199494999,-93.0856175505621,-63.0321384159762,53.1553114232179,41.4742463224904,16.7436883365372,104.23808360062,-34.4181646240076,-100.00922170618,3.47155299490898,-85.4894498595401,59.6480141950757,-55.2908601328611,91.3979867370876,108.290760743988,5.42011860323054,-76.2791470547749,-52.5634393541185,-97.7614174440492,103.223275561112,-69.1359837028094,59.6496125710285,35.3321453942107,-37.0840577932202,-69.4196406229038,100.914973298334,62.0457206201431,51.7913796204501,-100.443169923167,-92.4167058433574,-72.5777167514862,67.1017500675749,85.7887312637746,-76.5557511125351,-10.3937462735013,-129.823216217169,186.157548958437,-130.766555899541,-164.09149780479,147.40211026554,231.699120456583,-255.726615228078,71.4741213459351,121.02522955622,-169.924253633104,146.160620137154,3.06069860435647,-92.3110791025393,78.4580401591259,-25.4319150977956,73.088572376748,142.912014212231,246.9486947006,-267.042066896776,-14.5377887298697,196.104113207139,179.552016623346,-229.768123171647,-87.0058408772088,-93.1674172288335,91.7909938560068,60.1878779867208,-64.3330171786875,77.001972537752,79.6975729253657,26.9842811643248,-83.6907434859261,85.7377445484999,-144.202833753023,104.177698739529,-41.9284037118584,-246.339456410531,151.24311827849,-283.31483482584,285.482753773529,-261.946125917193,271.014460696898,-48.4389762123614,239.744339032937,261.824877652945,-263.095463251535,44.5398462560981,-273.911448080474,95.5730526501524,235.568079578949,-233.264171319263,268.29788217524,285.188271009259,-92.5361260926697,135.106630767084,38.812094459523,286.225785429804,136.863697328884,-11.4729325068946,364.298851836843,679.443281486844,-923.136001937492,569.990130215778],"x":[107.932974162373,-53.5965720858851,-25.3983230114088,-73.0522092612053,-93.2288132224917,-50.2555991225955,33.723260645487,-45.8013694702806,-18.5706416287649,-64.7112997752121,55.6454977615785,-87.9903989543212,-93.7406157155848,-99.8209849475799,107.065267615429,-30.2877169746095,-102.764502260485,41.9148620677168,-108.708163050336,-66.2535240882062,-90.2386073792007,93.0307227697083,57.5592923144988,-1.40289602110972,-108.393805307414,77.3537400454575,-94.8037737754161,46.3638869652891,33.2866220437947,83.739351861485,-90.8228731723972,-102.800705324714,-95.2430369341743,-73.3891973927984,-8.07398537068056,-79.8960867117244,-86.8950314931343,10.9849952737306,-40.1971417615259,70.2835479191457,-74.805545983788,-52.1691016515593,-64.9254440742338,-95.618112998986,-56.2705574533161,192.16230065912,290.832910799303,-193.832554579872,179.995515876935,-54.6238853581405,-159.550426203921,-231.148126536323,-195.805715538763,-138.541873206742,149.049014311733,182.016349818509,-37.3097574555833,-68.9634307705128,124.032275910836,-163.633231156133,-254.990159649986,127.923448314125,38.5675031986941,-291.383780714066,-200.904115725653,-172.716208151,89.3488402989791,-183.572554899845,-118.766216682369,-118.474969352928,-92.0439015338075,-69.4268707433247,-53.0413195280152,48.8780388936435,-89.727044269772,42.6196005165887,37.7298301000567,-13.3207503199545,157.524148774579,220.169464124023,-102.055418982766,-242.630923725256,-36.4567928495035,-0.169059524776606,-113.779996664927,-89.7136090058253,281.522711749918,155.579365929434,115.523784182304,-112.820506421065,-282.952438838825,-82.4013496594536,-269.087338041856,160.104825183994,164.474832801868,98.6737799632721,-16.6591862225212,270.177175213875,251.595699861259,-282.299734387552,-61.230910760292,357.685586758781,-489.683763640364,-473.135978970174,381.652788494177,277.096580006298,-971.421941265776],"z":[40.6,40.6,40.6,40.7,40.7,40.8,40.7,40.6,40.5,40.6,40.7,40.7,40.8,40.8,40.7,40.6,40.7,40.8,40.7,40.8,40.7,40.6,40.7,40.5,40.6,40.6,40.7,40.7,40.7,40.7,40.6,40.8,40.6,40.7,40.7,40.6,40.7,42.2,51.1,51.2,51.5,51.3,51.4,51.4,51.6,51.3,51.4,51.4,51.4,51.5,51.5,51.6,51.7,51.3,51.4,51.5,51.2,51.5,51.4,51.5,51.3,51.2,51.4,50.6,50.7,50.6,50.5,50.5,50.7,50.7,50.6,50.6,50.6,50.6,50.7,50.7,50.5,50.6,50.6,50.6,50.7,50.6,50.6,50.7,50.7,50.6,50.7,50.6,50.7,50.6,50.6,50.7,50.7,50.6,50.7,50.7,50.8,50.8,50.7,50.6,50.6,50.8,50.7,50.8,50.8,50.7,50.7],"mode":"markers","type":"scatter3d","marker":{"colorbar":{"title":"k_cluster_dbscan","ticklen":2},"cmin":0,"cmax":2,"colorscale":[["0","rgba(68,1,84,1)"],["0.5","rgba(37,144,140,1)"],["0.5","rgba(37,144,140,1)"],["0.5","rgba(37,144,140,1)"],["0.5","rgba(37,144,140,1)"],["0.5","rgba(37,144,140,1)"],["0.5","rgba(37,144,140,1)"],["0.5","rgba(37,144,140,1)"],["0.5","rgba(37,144,140,1)"],["0.5","rgba(37,144,140,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"]],"showscale":false,"color":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0,0,0,0],"line":{"colorbar":{"title":"","ticklen":2},"cmin":0,"cmax":2,"colorscale":[["0","rgba(68,1,84,1)"],["0.5","rgba(37,144,140,1)"],["0.5","rgba(37,144,140,1)"],["0.5","rgba(37,144,140,1)"],["0.5","rgba(37,144,140,1)"],["0.5","rgba(37,144,140,1)"],["0.5","rgba(37,144,140,1)"],["0.5","rgba(37,144,140,1)"],["0.5","rgba(37,144,140,1)"],["0.5","rgba(37,144,140,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"]],"showscale":false,"color":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0,0,0,0]}},"frame":null},{"x":[-971.421941265776,381.652788494177],"y":[-923.136001937492,679.443281486844],"type":"scatter3d","mode":"markers","opacity":0,"hoverinfo":"none","showlegend":false,"marker":{"colorbar":{"title":"k_cluster_dbscan","ticklen":2,"len":0.5,"lenmode":"fraction","y":1,"yanchor":"top"},"cmin":0,"cmax":2,"colorscale":[["0","rgba(68,1,84,1)"],["0.5","rgba(37,144,140,1)"],["0.5","rgba(37,144,140,1)"],["0.5","rgba(37,144,140,1)"],["0.5","rgba(37,144,140,1)"],["0.5","rgba(37,144,140,1)"],["0.5","rgba(37,144,140,1)"],["0.5","rgba(37,144,140,1)"],["0.5","rgba(37,144,140,1)"],["0.5","rgba(37,144,140,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"]],"showscale":true,"color":[0,2],"line":{"color":"rgba(255,127,14,1)"}},"z":[40.5,51.7],"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":[]}</script><!--/html_preserve-->

Clusters vizualised thru Principal Components  


```r
hullplot(angles_matrix_sca, db$cluster)
```

![](RMD_Clusterig_Summary_files/figure-html/Hull Plot-1.png)<!-- -->




```
## Within sum of squares: 
##  206.1225
```

  
## 4- Medoids Based K-means (PAM - Partition Medoids)

In k-medoids clustering, each cluster is represented by one of the data point in the cluster. These points are named cluster medoids.
K-medoid is a robust alternative to k-means clustering. This means that, the algorithm is less sensitive to noise and outliers, compared to k-means, because it uses medoids as cluster centers instead of means (used in k-means).
  

```r
pam.res <- pam(angles_matrix_sca, 3) 
```


```
## Within sum of squares: 
##  153.5372
```

<!--html_preserve--><div id="htmlwidget-6541819892f22e588847" style="width:960px;height:432px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-6541819892f22e588847">{"x":{"visdat":{"298865e01bf9":["function () ","plotlyVisDat"]},"cur_data":"298865e01bf9","attrs":{"298865e01bf9":{"y":{},"x":{},"z":{},"mode":"markers","color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":"x"},"yaxis":{"title":"y"},"zaxis":{"title":"z"}},"hovermode":"closest","showlegend":false,"legend":{"yanchor":"top","y":0.5}},"source":"A","config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"data":[{"y":[-11.1989155718138,-94.5215560217025,105.402509945865,79.8395071530135,54.5793663125589,95.7826463421585,-103.535058672989,99.0683873794258,-107.3798875915,87.3115199494999,-93.0856175505621,-63.0321384159762,53.1553114232179,41.4742463224904,16.7436883365372,104.23808360062,-34.4181646240076,-100.00922170618,3.47155299490898,-85.4894498595401,59.6480141950757,-55.2908601328611,91.3979867370876,108.290760743988,5.42011860323054,-76.2791470547749,-52.5634393541185,-97.7614174440492,103.223275561112,-69.1359837028094,59.6496125710285,35.3321453942107,-37.0840577932202,-69.4196406229038,100.914973298334,62.0457206201431,51.7913796204501,-100.443169923167,-92.4167058433574,-72.5777167514862,67.1017500675749,85.7887312637746,-76.5557511125351,-10.3937462735013,-129.823216217169,186.157548958437,-130.766555899541,-164.09149780479,147.40211026554,231.699120456583,-255.726615228078,71.4741213459351,121.02522955622,-169.924253633104,146.160620137154,3.06069860435647,-92.3110791025393,78.4580401591259,-25.4319150977956,73.088572376748,142.912014212231,246.9486947006,-267.042066896776,-14.5377887298697,196.104113207139,179.552016623346,-229.768123171647,-87.0058408772088,-93.1674172288335,91.7909938560068,60.1878779867208,-64.3330171786875,77.001972537752,79.6975729253657,26.9842811643248,-83.6907434859261,85.7377445484999,-144.202833753023,104.177698739529,-41.9284037118584,-246.339456410531,151.24311827849,-283.31483482584,285.482753773529,-261.946125917193,271.014460696898,-48.4389762123614,239.744339032937,261.824877652945,-263.095463251535,44.5398462560981,-273.911448080474,95.5730526501524,235.568079578949,-233.264171319263,268.29788217524,285.188271009259,-92.5361260926697,135.106630767084,38.812094459523,286.225785429804,136.863697328884,-11.4729325068946,364.298851836843,679.443281486844,-923.136001937492,569.990130215778],"x":[107.932974162373,-53.5965720858851,-25.3983230114088,-73.0522092612053,-93.2288132224917,-50.2555991225955,33.723260645487,-45.8013694702806,-18.5706416287649,-64.7112997752121,55.6454977615785,-87.9903989543212,-93.7406157155848,-99.8209849475799,107.065267615429,-30.2877169746095,-102.764502260485,41.9148620677168,-108.708163050336,-66.2535240882062,-90.2386073792007,93.0307227697083,57.5592923144988,-1.40289602110972,-108.393805307414,77.3537400454575,-94.8037737754161,46.3638869652891,33.2866220437947,83.739351861485,-90.8228731723972,-102.800705324714,-95.2430369341743,-73.3891973927984,-8.07398537068056,-79.8960867117244,-86.8950314931343,10.9849952737306,-40.1971417615259,70.2835479191457,-74.805545983788,-52.1691016515593,-64.9254440742338,-95.618112998986,-56.2705574533161,192.16230065912,290.832910799303,-193.832554579872,179.995515876935,-54.6238853581405,-159.550426203921,-231.148126536323,-195.805715538763,-138.541873206742,149.049014311733,182.016349818509,-37.3097574555833,-68.9634307705128,124.032275910836,-163.633231156133,-254.990159649986,127.923448314125,38.5675031986941,-291.383780714066,-200.904115725653,-172.716208151,89.3488402989791,-183.572554899845,-118.766216682369,-118.474969352928,-92.0439015338075,-69.4268707433247,-53.0413195280152,48.8780388936435,-89.727044269772,42.6196005165887,37.7298301000567,-13.3207503199545,157.524148774579,220.169464124023,-102.055418982766,-242.630923725256,-36.4567928495035,-0.169059524776606,-113.779996664927,-89.7136090058253,281.522711749918,155.579365929434,115.523784182304,-112.820506421065,-282.952438838825,-82.4013496594536,-269.087338041856,160.104825183994,164.474832801868,98.6737799632721,-16.6591862225212,270.177175213875,251.595699861259,-282.299734387552,-61.230910760292,357.685586758781,-489.683763640364,-473.135978970174,381.652788494177,277.096580006298,-971.421941265776],"z":[40.6,40.6,40.6,40.7,40.7,40.8,40.7,40.6,40.5,40.6,40.7,40.7,40.8,40.8,40.7,40.6,40.7,40.8,40.7,40.8,40.7,40.6,40.7,40.5,40.6,40.6,40.7,40.7,40.7,40.7,40.6,40.8,40.6,40.7,40.7,40.6,40.7,42.2,51.1,51.2,51.5,51.3,51.4,51.4,51.6,51.3,51.4,51.4,51.4,51.5,51.5,51.6,51.7,51.3,51.4,51.5,51.2,51.5,51.4,51.5,51.3,51.2,51.4,50.6,50.7,50.6,50.5,50.5,50.7,50.7,50.6,50.6,50.6,50.6,50.7,50.7,50.5,50.6,50.6,50.6,50.7,50.6,50.6,50.7,50.7,50.6,50.7,50.6,50.7,50.6,50.6,50.7,50.7,50.6,50.7,50.7,50.8,50.8,50.7,50.6,50.6,50.8,50.7,50.8,50.8,50.7,50.7],"mode":"markers","type":"scatter3d","marker":{"colorbar":{"title":"k_cluster_pam","ticklen":2},"cmin":1,"cmax":3,"colorscale":[["0","rgba(68,1,84,1)"],["0","rgba(68,1,84,1)"],["0","rgba(68,1,84,1)"],["0","rgba(68,1,84,1)"],["0","rgba(68,1,84,1)"],["0","rgba(68,1,84,1)"],["0","rgba(68,1,84,1)"],["0","rgba(68,1,84,1)"],["0","rgba(68,1,84,1)"],["0.5","rgba(37,144,140,1)"],["0.5","rgba(37,144,140,1)"],["0.5","rgba(37,144,140,1)"],["0.5","rgba(37,144,140,1)"],["0.5","rgba(37,144,140,1)"],["0.5","rgba(37,144,140,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"]],"showscale":false,"color":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,3,3,2,3,2,3,2,2,3,3,2,3,3,2,3,2,2,3,2,3,3,3,2,3,3,3,2,2,2,3,3,2,3,3,3,2,3,2,3,2,2,3,2,3,2,3,2,3,3,2,3,2,3,3,2,3,3,2,3,3,3,3,3,3,3,2,3],"line":{"colorbar":{"title":"","ticklen":2},"cmin":1,"cmax":3,"colorscale":[["0","rgba(68,1,84,1)"],["0","rgba(68,1,84,1)"],["0","rgba(68,1,84,1)"],["0","rgba(68,1,84,1)"],["0","rgba(68,1,84,1)"],["0","rgba(68,1,84,1)"],["0","rgba(68,1,84,1)"],["0","rgba(68,1,84,1)"],["0","rgba(68,1,84,1)"],["0.5","rgba(37,144,140,1)"],["0.5","rgba(37,144,140,1)"],["0.5","rgba(37,144,140,1)"],["0.5","rgba(37,144,140,1)"],["0.5","rgba(37,144,140,1)"],["0.5","rgba(37,144,140,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"]],"showscale":false,"color":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,3,3,2,3,2,3,2,2,3,3,2,3,3,2,3,2,2,3,2,3,3,3,2,3,3,3,2,2,2,3,3,2,3,3,3,2,3,2,3,2,2,3,2,3,2,3,2,3,3,2,3,2,3,3,2,3,3,2,3,3,3,3,3,3,3,2,3]}},"frame":null},{"x":[-971.421941265776,381.652788494177],"y":[-923.136001937492,679.443281486844],"type":"scatter3d","mode":"markers","opacity":0,"hoverinfo":"none","showlegend":false,"marker":{"colorbar":{"title":"k_cluster_pam","ticklen":2,"len":0.5,"lenmode":"fraction","y":1,"yanchor":"top"},"cmin":1,"cmax":3,"colorscale":[["0","rgba(68,1,84,1)"],["0","rgba(68,1,84,1)"],["0","rgba(68,1,84,1)"],["0","rgba(68,1,84,1)"],["0","rgba(68,1,84,1)"],["0","rgba(68,1,84,1)"],["0","rgba(68,1,84,1)"],["0","rgba(68,1,84,1)"],["0","rgba(68,1,84,1)"],["0.5","rgba(37,144,140,1)"],["0.5","rgba(37,144,140,1)"],["0.5","rgba(37,144,140,1)"],["0.5","rgba(37,144,140,1)"],["0.5","rgba(37,144,140,1)"],["0.5","rgba(37,144,140,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"],["1","rgba(253,231,37,1)"]],"showscale":true,"color":[1,3],"line":{"color":"rgba(255,127,14,1)"}},"z":[40.5,51.7],"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":[]}</script><!--/html_preserve-->

# Summary

##Summary Table  

```
## # A tibble: 4 x 2
##   Approach       Sum_of_Sq
##   <chr>              <dbl>
## 1 K-Means Scaled      108.
## 2 PAM                 154.
## 3 DBSCAN              206.
## 4 K-Means Basic   2868092.
```

##Conclusion
Based on **Within Sum of Sqaures** metric we can assume that the best approach is **K-Means Scaled** clustering data in 4 groups.
Despite this mathematical conclusion, checking the corresponding plots might give a better understanding of the situation either to confirm or not the approach accuracy.




